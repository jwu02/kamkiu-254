# 254报告自动化

## 安装
- 下载 Python（编程语言）
    - https://www.python.org/downloads/release/python-3135/
- 下载 Visual Studio Code（代码编辑器）
    - https://code.visualstudio.com/Download

### 更改编辑器语言
- Ctrl + Shift + P
- 输入：Configure Display Language
- 找：中文（简体）

### 设置环境
- 打开 终端
    - Ctrl + J
- 下载需要的软件包（命令只需要运行一次，以后都不用）
    - pip install -r requirements.txt

### 运行
- 打开 终端
    - Ctrl + J
- python main.py

## 操作

### 数据导入
- 发货批次表
    - ME → A产品每日发货批次表（493）
    - 更改布局，删除第一列挤压批号
    - 导出为 CSV
- 性能（按时效批次搜索）
    - ME -> 委托单明细（wtdmx）
    - 型号
    - 时效批次
    - 左边 导出数据（快）为 xlsx
        - 然后WPS Excel里打开
        - 另存为 UTF-8 CSV（注意是UTF-8的选项）
        - 如果程序还是导不进数据，去找个 xlsx转CSV 的网站来搞
- 性能（按熔铸炉号搜索）
    - ME -> 委托单明细（wtdmx）
    - 型号
    - 熔铸炉号
- 化学成分
    - ME -> 成分
    - 熔铸炉号
- 型材时效二维码
    - ME -> 型材时效二维码（新）（507）
    - 型号
    - 生产挤压批：（挤压批号）
    - 导出为 CSV
- 流程卡二维码记录
    - ME -> 流程卡二维码记录（pz230）
    - sfc：（时效批号*）
    - 型号
    - 挤压批号
    - 导出为 CSV

### 功能
- 检查CPK
    - 查看哪些CPK存在，方便刷CPK
    - 建议每次刷完一个CPK，重新点击一下有什么更新，为了避免为以前刷过的CPK的挤压批号又刷一个
- 检查化学成分
    - 采取 `data/成分_元素条件.csv` 里的要求来判断合不合格
- 采取 挤压批此（二维码） & 熔铸批号
- 采取 时效批次（二维码）
- 对数量
    - 汇总选定文件夹，每个型号的发货数量
- 单独生成报告
    - 需要 CPK、性能、成分数据 才可以生成
    - 对应 每车（客户+地区）型号+炉号 的报告存在的话，就不会再次生成
- 生成全部报告
    - 一次性把全部报告生成
    - 需要把CPK全刷完，每
    - 算法 会拿第一个存在
    - 每个型号+炉号的组合，需要一个存在的CPK（毕竟报告是按炉号做的）


## 注意
- 用WPS表格更改过的 CSV 没办法上传上去 并报以下错误
    - 'utf-8' codec can't decode byte 0xbf in position 0; invalid start byte
    - 问题在于 WPS 表格 saves files with different encodings
        - but pandas tries to read a CSV file that's not actually encoded in UTF-8
    - 需要用另一个打开方式（记事本）来更改数据
- 别刷CPK刷上头，注意型号的更变

## 常问

